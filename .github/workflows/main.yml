name: Deploy EF Azure Database
on:
  push:
    branches: [ develop ]
jobs: 
  build:
    name: Build sql action
    runs-on: ubuntu-latest
    steps:
    - name: Check out repository
      uses: actions/checkout@v3
    - name: 'Az CLI login with subscription'
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    - name: Unchecked Azure services access to database to check authentication
      uses: azure/sql-action@v2
      with:        
        connection-string: ${{ secrets.AZURE_SQL_CONNECTION_STRING }}
        path: './Database.sqlproj'
        action: 'publish'